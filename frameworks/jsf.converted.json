{
  "$schema": "../schema/framework-schema.json",
  "name": "Jsf",
  "languages": [
    "java"
  ],
  "extends": "java",
  "detection": {
    "files": {
      "type": "filename",
      "patterns": [
        "faces-config.xml"
      ]
    },
    "dependencies": {
      "pom.xml": [
        {
          "artifact": "javax.faces",
          "library": "JSF"
        }
      ],
      "build.gradle": [
        {
          "pattern": "javax.faces",
          "library": "JSF"
        }
      ]
    },
    "imports": {
      "type": "joern",
      "search_type": "import",
      "patterns": [
        "com.sun.faces.application.*",
        "com.sun.faces.application.resource.*",
        "com.sun.faces.context.*",
        "com.sun.faces.facelets.tag.jstl.fn.*",
        "com.sun.faces.io.*",
        "org.ajax4jsf.javascript.*",
        "org.ajax4jsf.util.base64.*",
        "org.apache.myfaces.shade.commons.codec.binary.*",
        "org.apache.myfaces.shared.renderkit.html.util.*",
        "org.apache.myfaces.shared_impl.renderkit.html.util.*"
      ]
    }
  },
  "architecture": {
    "database": {
      "repository_pattern": [
        {
          "target": "joern",
          "search_type": "class_name_regex",
          "pattern": ".*Repository.*|.*DAO.*"
        }
      ],
      "operation_methods": [
        {
          "target": "joern",
          "search_type": "method_name_regex",
          "pattern": "save|persist|find.*|delete.*"
        }
      ]
    },
    "data_flow": {
      "input_sources": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "com.sun.faces.context.RequestHeaderValuesMap.get(java.lang.Object)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.trinidadinternal.context.external.ServletRequestHeaderValuesMap.getAttribute(java.lang.Object)"
        }
      ]
    },
    "security": {
      "sanitization": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "com.sun.faces.application.ApplicationAssociate.urlIsRelatedToDefiningDocumentInJar(java.net.URL,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "com.sun.faces.application.resource.ResourceHandlerImpl.libraryNameIsSafe(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "com.sun.faces.application.resource.ResourceManager.nameContainsForbiddenSequence(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "com.sun.faces.facelets.tag.jstl.fn.JstlFunction.escapeXml(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.ajax4jsf.javascript.ScriptUtils.escapeCSSMetachars(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared.renderkit.html.util.HTMLEncoder.encode(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared.renderkit.html.util.HTMLEncoder.encode(java.lang.String,boolean)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared.renderkit.html.util.HTMLEncoder.encode(java.lang.String,boolean,boolean)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared.renderkit.html.util.HTMLEncoder.encode(java.lang.String,boolean,boolean,boolean)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared.renderkit.html.util.HTMLEncoder.encodeURIAttribute(java.lang.String,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared.renderkit.html.util.HTMLEncoder.encode(java.io.Writer,java.lang.String,boolean,boolean,boolean)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared_impl.renderkit.html.util.HTMLEncoder.encode(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared_impl.renderkit.html.util.HTMLEncoder.encode(java.lang.String,boolean)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared_impl.renderkit.html.util.HTMLEncoder.encode(java.lang.String,boolean,boolean)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared_impl.renderkit.html.util.HTMLEncoder.encode(java.lang.String,boolean,boolean,boolean)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared_impl.renderkit.html.util.HTMLEncoder.encodeURIAttribute(java.lang.String,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared_tomahawk.renderkit.html.util.HTMLEncoder.encode(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared_tomahawk.renderkit.html.util.HTMLEncoder.encode(java.lang.String,boolean)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared_tomahawk.renderkit.html.util.HTMLEncoder.encode(java.lang.String,boolean,boolean)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared_tomahawk.renderkit.html.util.HTMLEncoder.encode(java.lang.String,boolean,boolean,boolean)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shared_tomahawk.renderkit.html.util.HTMLEncoder.encodeURIAttribute(java.lang.String,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.ajax4jsf.util.base64.URL64Codec.encodeBase64(byte[],boolean)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shade.commons.codec.binary.Base64.encodeBase64(byte[],boolean)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "com.sun.faces.io.Base64InputStream.decode(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.ajax4jsf.util.base64.URL64Codec.decodeBase64(byte[])"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.myfaces.shade.commons.codec.binary.Base64.decodeBase64(byte[])"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.ajax4jsf.util.base64.URLCodec.encodeUrl(java.util.BitSet,byte[])"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.richfaces.resource.ResourceUtils.encodeURIQueryPart(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.ajax4jsf.util.base64.URLCodec.decodeUrl(byte[])"
        }
      ]
    }
  }
}