{
  "$schema": "../schema/framework-schema.json",
  "name": "Apache",
  "languages": [
    "java"
  ],
  "extends": "java",
  "detection": {
    "dependencies": {},
    "imports": {
      "type": "joern",
      "search_type": "import",
      "patterns": [
        "org.apache.axis.message.*",
        "org.apache.catalina.util.*",
        "org.apache.commons.fileupload.*",
        "org.apache.commons.httpclient.*",
        "org.apache.commons.lang.*",
        "org.apache.commons.lang3.*",
        "org.apache.cxf.jaxrs.utils.*",
        "org.apache.jackrabbit.util.*",
        "org.apache.taglibs.standard.tag.common.core.*",
        "org.apache.taglibs.standard.util.*"
      ]
    }
  },
  "architecture": {
    "database": {
      "repository_pattern": {
        "type": "joern",
        "search_type": "class_name_regex",
        "pattern": ".*Repository.*|.*DAO.*"
      },
      "operation_methods": {
        "type": "joern",
        "search_type": "method_name_regex",
        "pattern": "save|persist|find.*|delete.*"
      }
    },
    "data_flow": {
      "input_sources": {
        "type": "joern",
        "search_type": "method_signature",
        "signatures": [
          "org.apache.commons.fileupload.FileItem.getInputStream()",
          "org.apache.commons.fileupload.FileItem.getContentType()",
          "org.apache.commons.fileupload.FileItem.getName()",
          "org.apache.commons.fileupload.FileItem.get()",
          "org.apache.commons.fileupload.FileItem.getString()",
          "org.apache.commons.fileupload.FileItem.getString(java.lang.String)",
          "org.apache.commons.fileupload.FileItem.getFieldName()",
          "org.apache.axis.message.RPCParam.getObjectValue()",
          "org.apache.axis.message.RPCParam.getValue()",
          "org.apache.commons.httpclient.HttpMethod.getResponseBody()",
          "org.apache.commons.httpclient.HttpMethod.getResponseBodyAsString()",
          "org.apache.commons.httpclient.HttpMethod.getResponseBodyAsStream()",
          "org.apache.commons.httpclient.HttpMethod.getResponseHeaders()",
          "org.apache.commons.httpclient.HttpMethod.getResponseHeaders(java.lang.String)",
          "org.apache.commons.httpclient.HttpMethod.getResponseHeader(java.lang.String)",
          "org.apache.cxf.jaxrs.utils.JAXRSUtils.createHttpParameterValue(org.apache.cxf.jaxrs.model.Parameter,java.lang.Class,java.lang.reflect.Type,java.lang.annotation.Annotation[],org.apache.cxf.message.Message,javax.ws.rs.core.MultivaluedMap,org.apache.cxf.jaxrs.model.OperationResourceInfo)"
        ]
      }
    },
    "logging": {
      "operations": {
        "type": "joern",
        "search_type": "method_signature",
        "signatures": [
          "org.apache.commons.logging.Log.trace:void(java.lang.Object)",
          "org.apache.commons.logging.Log.trace:void(java.lang.Object,java.lang.Throwable)",
          "org.apache.commons.logging.Log.debug:void(java.lang.Object)",
          "org.apache.commons.logging.Log.debug:void(java.lang.Object,java.lang.Throwable)",
          "org.apache.commons.logging.Log.info:void(java.lang.Object)",
          "org.apache.commons.logging.Log.info:void(java.lang.Object,java.lang.Throwable)",
          "org.apache.commons.logging.Log.warn:void(java.lang.Object)",
          "org.apache.commons.logging.Log.warn:void(java.lang.Object,java.lang.Throwable)",
          "org.apache.commons.logging.Log.error:void(java.lang.Object)",
          "org.apache.commons.logging.Log.error:void(java.lang.Object,java.lang.Throwable)",
          "org.apache.commons.logging.Log.fatal:void(java.lang.Object)",
          "org.apache.commons.logging.Log.fatal:void(java.lang.Object,java.lang.Throwable)"
        ]
      }
    },
    "security": {
      "sanitization": {
        "type": "joern",
        "search_type": "method_signature",
        "signatures": [
          "org.apache.jackrabbit.util.Text.encodeIllegalXMLCharacters(java.lang.String)",
          "org.apache.catalina.util.URLEncoder.encode(java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.escapeHtml(java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.escapeJavaScript(java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.escapeXml(java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.escapeSQL(java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.unescapeHtml(java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.unescapeJavaScript(java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.unescapeXml(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeCsv(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeHtml3(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeHtml4(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeJson(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeXml(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeXml10(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeXml11(java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.escapeSql(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.unescapeCsv(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.unescapeHtml3(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.unescapeHtml4(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.unescapeJson(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.unescapeXml(java.lang.String)",
          "org.apache.taglibs.standard.tag.common.core.Util.escapeXml(java.lang.String)",
          "org.apache.taglibs.standard.util.EscapeXML.escape(java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.escapeCsv(java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.escapeCsv(java.io.Writer,java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.unescapeCsv(java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.unescapeCsv(java.io.Writer,java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.escapeHtml(java.io.Writer,java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.unescapeHtml(java.io.Writer,java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.escapeJavaScript(java.io.Writer,java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.unescapeJavaScript(java.io.Writer,java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.escapeXml(java.io.Writer,java.lang.String)",
          "org.apache.commons.lang.StringEscapeUtils.unescapeXml(java.io.Writer,java.lang.String)",
          "org.apache.commons.lang3.StringUtils.strip:java.lang.String(java.lang.String)",
          "org.apache.commons.lang3.StringUtils.stripAll:java.lang.String[](java.lang.String[])",
          "org.apache.commons.lang3.StringUtils.stripToNull:java.lang.String(java.lang.String)",
          "org.apache.commons.lang3.StringUtils.stripToEmpty:java.lang.String(java.lang.String)",
          "org.apache.commons.lang3.StringUtils.trim:java.lang.String(java.lang.String)",
          "org.apache.commons.lang3.StringUtils.trimToNull:java.lang.String(java.lang.String)",
          "org.apache.commons.lang3.StringUtils.trimToEmpty:java.lang.String(java.lang.String)"
        ]
      },
      "input_validation": {
        "type": "joern",
        "search_type": "method_signature",
        "signatures": [
          "org.apache.commons.validator.GenericValidator.isBlankOrNull:boolean(java.lang.String)",
          "org.apache.commons.validator.GenericValidator.isEmail:boolean(java.lang.String)",
          "org.apache.commons.validator.GenericValidator.isUrl:boolean(java.lang.String)",
          "org.apache.commons.validator.GenericValidator.isInRange:boolean(int,int,int)",
          "org.apache.commons.validator.GenericValidator.matchRegexp:boolean(java.lang.String,java.lang.String)",
          "org.apache.commons.validator.routines.EmailValidator.isValid:boolean(java.lang.String)",
          "org.apache.commons.validator.routines.UrlValidator.isValid:boolean(java.lang.String)",
          "org.apache.commons.validator.routines.RegexValidator.isValid:boolean(java.lang.String)"
        ]
      },
      "output_encoding": {
        "type": "joern",
        "search_type": "method_signature",
        "signatures": [
          "org.apache.commons.text.StringEscapeUtils.escapeHtml4:java.lang.String(java.lang.String)",
          "org.apache.commons.text.StringEscapeUtils.escapeHtml3:java.lang.String(java.lang.String)",
          "org.apache.commons.text.StringEscapeUtils.escapeXml10:java.lang.String(java.lang.String)",
          "org.apache.commons.text.StringEscapeUtils.escapeXml11:java.lang.String(java.lang.String)",
          "org.apache.commons.text.StringEscapeUtils.escapeEcmaScript:java.lang.String(java.lang.String)",
          "org.apache.commons.text.StringEscapeUtils.escapeJson:java.lang.String(java.lang.String)",
          "org.apache.commons.text.StringEscapeUtils.escapeJava:java.lang.String(java.lang.String)",
          "org.apache.commons.text.StringEscapeUtils.escapeCsv:java.lang.String(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeHtml4:java.lang.String(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeHtml3:java.lang.String(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeXml:java.lang.String(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeXml10:java.lang.String(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeXml11:java.lang.String(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeEcmaScript:java.lang.String(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeJson:java.lang.String(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeJava:java.lang.String(java.lang.String)",
          "org.apache.commons.lang3.StringEscapeUtils.escapeCsv:java.lang.String(java.lang.String)"
        ]
      }
    }
  }
}
