{
  "$schema": "../schema/framework-schema.json",
  "name": "Spring Framework",
  "languages": [
    "java",
    "kotlin"
  ],
  "extends": "java",
  "detection": {
    "files": {
      "target": "filename",
      "pattern": [
        "pom.xml",
        "build.gradle",
        "build.gradle.kts"
      ]
    },
    "dependencies": {
      "pom.xml": [
        {
          "artifact": "spring-boot-starter",
          "library": "Spring Boot"
        },
        {
          "artifact": "spring-boot-starter-web",
          "library": "Spring Boot Web"
        },
        {
          "artifact": "spring-webmvc",
          "library": "Spring Web MVC"
        },
        {
          "artifact": "spring-web",
          "library": "Spring Web"
        },
        {
          "artifact": "spring-context",
          "library": "Spring Context"
        }
      ],
      "build.gradle": [
        {
          "pattern": "org.springframework.boot",
          "library": "Spring Boot"
        },
        {
          "pattern": "org.springframework:spring",
          "library": "Spring Framework"
        }
      ]
    }
  },
  "architecture": {
    "routing": {
      "route_definitions": [
        {
          "target": "joern",
          "search_type": "annotation_name",
          "pattern": [
            "RequestMapping",
            "GetMapping",
            "PostMapping",
            "PutMapping",
            "DeleteMapping",
            "PatchMapping"
          ],
          "description": "route_definitions.annotations patterns"
        },
        {
          "target": "joern",
          "search_type": "annotation_name",
          "pattern": {
            "get": "GetMapping",
            "post": "PostMapping",
            "put": "PutMapping",
            "delete": "DeleteMapping",
            "patch": "PatchMapping",
            "generic": "RequestMapping"
          },
          "description": "route_definitions.http_methods named patterns"
        }
      ],
      "parameters": [
        {
          "target": "joern",
          "search_type": "annotation_name",
          "pattern": "PathVariable"
        },
        {
          "target": "joern",
          "search_type": "annotation_name",
          "pattern": "RequestParam"
        },
        {
          "target": "joern",
          "search_type": "annotation_name",
          "pattern": "RequestBody"
        },
        {
          "target": "joern",
          "search_type": "annotation_name",
          "pattern": "ModelAttribute|Valid|Validated"
        }
      ],
      "handler_classes": [
        {
          "target": "joern",
          "search_type": "class_name_regex",
          "pattern": ".*Controller"
        },
        {
          "target": "joern",
          "search_type": "annotation_name",
          "pattern": [
            "Controller",
            "RestController"
          ],
          "description": "handler_classes.annotations patterns"
        }
      ],
      "component_definitions": [
        {
          "target": "joern",
          "search_type": "annotation_name",
          "pattern": [
            "Component",
            "Service",
            "Repository",
            "Configuration",
            "Bean",
            "SpringBootApplication"
          ],
          "description": "component_definitions.annotations patterns"
        }
      ],
      "dependency_injection": [
        {
          "target": "joern",
          "search_type": "annotation_name",
          "pattern": [
            "Autowired",
            "Inject",
            "Resource",
            "Value",
            "Qualifier"
          ],
          "description": "dependency_injection.annotations patterns"
        }
      ]
    },
    "execution": {
      "expression": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.expression.spel.standard.SpelExpressionParser.parseExpression:org.springframework.expression.Expression(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.expression.spel.standard.SpelExpressionParser.parseExpression:org.springframework.expression.Expression(java.lang.String,org.springframework.expression.ParserContext)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.expression.ExpressionParser.parseExpression:org.springframework.expression.Expression(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.expression.ExpressionParser.parseExpression:org.springframework.expression.Expression(java.lang.String,org.springframework.expression.ParserContext)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.expression.Expression.getValue:java.lang.Object()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.expression.Expression.getValue:java.lang.Object(java.lang.Object)"
        }
      ]
    },
    "data_flow": {
      "input_sources": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.context.request.RequestContextHolder.getRequestAttributes:org.springframework.web.context.request.RequestAttributes()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.context.request.ServletRequestAttributes.getRequest:javax.servlet.http.HttpServletRequest()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.context.request.ServletRequestAttributes.getResponse:javax.servlet.http.HttpServletResponse()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.multipart.MultipartFile.getBytes:byte[]()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.multipart.MultipartFile.getInputStream:java.io.InputStream()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.multipart.MultipartFile.transferTo:void(java.io.File)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.multipart.MultipartFile.getOriginalFilename:java.lang.String()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.multipart.MultipartFile.getName:java.lang.String()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.multipart.MultipartFile.getResource:org.springframework.core.io.Resource()"
        }
      ]
    },
    "communication": {
      "http": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.client.RestTemplate.getForObject:java.lang.Object(java.lang.String,java.lang.Class,java.lang.Object[])"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.client.RestTemplate.getForEntity:org.springframework.http.ResponseEntity(java.lang.String,java.lang.Class,java.lang.Object[])"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.client.RestTemplate.postForObject:java.lang.Object(java.lang.String,java.lang.Object,java.lang.Class,java.lang.Object[])"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.client.RestTemplate.postForEntity:org.springframework.http.ResponseEntity(java.lang.String,java.lang.Object,java.lang.Class,java.lang.Object[])"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.client.RestTemplate.exchange:org.springframework.http.ResponseEntity(java.lang.String,org.springframework.http.HttpMethod,org.springframework.http.HttpEntity,java.lang.Class,java.lang.Object[])"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.client.RestTemplate.execute:java.lang.Object(java.lang.String,org.springframework.http.HttpMethod,org.springframework.web.client.RequestCallback,org.springframework.web.client.ResponseExtractor,java.lang.Object[])"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.reactive.function.client.WebClient.create:org.springframework.web.reactive.function.client.WebClient(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.reactive.function.client.WebClient$RequestHeadersUriSpec.uri:org.springframework.web.reactive.function.client.WebClient$RequestHeadersSpec(java.lang.String,java.lang.Object[])"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.reactive.function.client.WebClient.get:org.springframework.web.reactive.function.client.WebClient$RequestHeadersUriSpec()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.reactive.function.client.WebClient.post:org.springframework.web.reactive.function.client.WebClient$RequestBodyUriSpec()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.reactive.function.client.WebClient.put:org.springframework.web.reactive.function.client.WebClient$RequestBodyUriSpec()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.reactive.function.client.WebClient.delete:org.springframework.web.reactive.function.client.WebClient$RequestHeadersUriSpec()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.reactive.function.client.WebClient.patch:org.springframework.web.reactive.function.client.WebClient$RequestBodyUriSpec()"
        }
      ]
    },
    "database": {
      "sql_queries": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.jdbc.core.JdbcTemplate.execute:void(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.jdbc.core.JdbcTemplate.query:java.util.List(java.lang.String,org.springframework.jdbc.core.RowMapper)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.jdbc.core.JdbcTemplate.queryForObject:java.lang.Object(java.lang.String,java.lang.Class)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.jdbc.core.JdbcTemplate.update:int(java.lang.String)"
        }
      ],
      "transactions": [
        {
          "target": "joern",
          "search_type": "annotation_name",
          "pattern": [
            "Transactional",
            "EnableTransactionManagement"
          ],
          "description": "transactions.annotations patterns"
        }
      ]
    },
    "presentation": {
      "redirects": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.servlet.view.RedirectView.<init>:void(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.servlet.view.RedirectView.setUrl:void(java.lang.String)"
        }
      ]
    },
    "integration": {
      "email": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.mail.SimpleMailMessage.setFrom:void(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.mail.SimpleMailMessage.setTo:void(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.mail.SimpleMailMessage.setTo:void(java.lang.String[])"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.mail.SimpleMailMessage.setCc:void(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.mail.SimpleMailMessage.setCc:void(java.lang.String[])"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.mail.SimpleMailMessage.setSubject:void(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.mail.SimpleMailMessage.setText:void(java.lang.String)"
        }
      ]
    },
    "exposure_locations": {
      "endpoints": [
        {
          "target": "joern",
          "search_type": "annotation_name",
          "pattern": [
            "RequestMapping",
            "GetMapping",
            "PostMapping",
            "PutMapping",
            "DeleteMapping",
            "PatchMapping"
          ],
          "description": "endpoints patterns"
        }
      ],
      "service_methods": [
        {
          "target": "joern",
          "search_type": "annotation_name",
          "pattern": [
            "Service",
            "Component"
          ],
          "description": "service_methods patterns"
        }
      ],
      "repository_methods": [
        {
          "target": "joern",
          "search_type": "annotation_name",
          "pattern": [
            "Repository"
          ],
          "description": "repository_methods patterns"
        }
      ]
    },
    "security": {
      "authentication": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.security.core.context.SecurityContextHolder.getContext:org.springframework.security.core.context.SecurityContext()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.security.authentication.AuthenticationManager.authenticate:org.springframework.security.core.Authentication(org.springframework.security.core.Authentication)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.security.core.context.SecurityContext.getAuthentication:org.springframework.security.core.Authentication()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.security.oauth2.jwt.JwtDecoder.decode:org.springframework.security.oauth2.jwt.Jwt(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.security.oauth2.jwt.JwtEncoder.encode:org.springframework.security.oauth2.jwt.Jwt(org.springframework.security.oauth2.jwt.JwtEncoderParameters)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.security.oauth2.jwt.NimbusJwtDecoder.withJwkSetUri:org.springframework.security.oauth2.jwt.NimbusJwtDecoder$JwkSetUriJwtDecoderBuilder(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.security.oauth2.jwt.NimbusJwtDecoder.withPublicKey:org.springframework.security.oauth2.jwt.NimbusJwtDecoder$PublicKeyJwtDecoderBuilder(java.security.interfaces.RSAPublicKey)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.security.oauth2.jwt.NimbusJwtDecoder.withSecretKey:org.springframework.security.oauth2.jwt.NimbusJwtDecoder$SecretKeyBuilder(javax.crypto.SecretKey)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.security.oauth2.jwt.NimbusJwtEncoder.<init>:void(com.nimbusds.jose.jwk.source.JWKSource)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationConverter.convert:org.springframework.security.core.Authentication(org.springframework.security.oauth2.jwt.Jwt)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.security.oauth2.server.resource.authentication.JwtAuthenticationProvider.authenticate:org.springframework.security.core.Authentication(org.springframework.security.core.Authentication)"
        }
      ],
      "authorization": [
        {
          "target": "joern",
          "search_type": "annotation_name",
          "pattern": [
            "PreAuthorize",
            "PostAuthorize",
            "PreFilter",
            "PostFilter",
            "Secured",
            "RolesAllowed"
          ],
          "description": "authorization.annotations patterns"
        }
      ],
      "sanitization": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.validation.Validator.validate:void(java.lang.Object,org.springframework.validation.Errors)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.validation.DataBinder.validate:void()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.bind.WebDataBinder.validate:void(java.lang.Object[])"
        }
      ],
      "input_validation": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.validation.Validator.validate:void(java.lang.Object,org.springframework.validation.Errors)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.validation.Validator.supports:boolean(java.lang.Class)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.validation.ValidationUtils.rejectIfEmpty:void(org.springframework.validation.Errors,java.lang.String,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.validation.ValidationUtils.rejectIfEmptyOrWhitespace:void(org.springframework.validation.Errors,java.lang.String,java.lang.String)"
        }
      ],
      "output_encoding": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.util.HtmlUtils.htmlEscape:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.util.HtmlUtils.htmlEscapeDecimal:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.util.HtmlUtils.htmlEscapeHex:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.util.JavaScriptUtils.javaScriptEscape:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.util.UriUtils.encode:java.lang.String(java.lang.String,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.util.UriUtils.encodeFragment:java.lang.String(java.lang.String,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.util.UriUtils.encodePath:java.lang.String(java.lang.String,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.util.UriUtils.encodePathSegment:java.lang.String(java.lang.String,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.util.UriUtils.encodeQuery:java.lang.String(java.lang.String,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.springframework.web.util.UriUtils.encodeQueryParam:java.lang.String(java.lang.String,java.lang.String)"
        }
      ]
    }
  }
}
