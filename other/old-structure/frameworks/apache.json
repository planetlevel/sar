{
  "$schema": "../schema/framework-schema.json",
  "name": "Apache",
  "languages": [
    "java"
  ],
  "extends": "java",
  "detection": {
    "dependencies": {},
    "imports": {
      "search_type": "import",
      "target": "joern",
      "pattern": [
        "org.apache.axis.message.*",
        "org.apache.catalina.util.*",
        "org.apache.commons.fileupload.*",
        "org.apache.commons.httpclient.*",
        "org.apache.commons.lang.*",
        "org.apache.commons.lang3.*",
        "org.apache.cxf.jaxrs.utils.*",
        "org.apache.jackrabbit.util.*",
        "org.apache.taglibs.standard.tag.common.core.*",
        "org.apache.taglibs.standard.util.*"
      ]
    }
  },
  "architecture": {
    "database": {
      "repository_pattern": [
        {
          "target": "joern",
          "search_type": "class_name_regex",
          "pattern": ".*Repository.*|.*DAO.*"
        }
      ],
      "operation_methods": [
        {
          "target": "joern",
          "search_type": "method_name_regex",
          "pattern": "save|persist|find.*|delete.*"
        }
      ]
    },
    "data_flow": {
      "input_sources": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.fileupload.FileItem.getInputStream()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.fileupload.FileItem.getContentType()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.fileupload.FileItem.getName()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.fileupload.FileItem.get()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.fileupload.FileItem.getString()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.fileupload.FileItem.getString(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.fileupload.FileItem.getFieldName()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.axis.message.RPCParam.getObjectValue()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.axis.message.RPCParam.getValue()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.httpclient.HttpMethod.getResponseBody()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.httpclient.HttpMethod.getResponseBodyAsString()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.httpclient.HttpMethod.getResponseBodyAsStream()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.httpclient.HttpMethod.getResponseHeaders()"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.httpclient.HttpMethod.getResponseHeaders(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.httpclient.HttpMethod.getResponseHeader(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.cxf.jaxrs.utils.JAXRSUtils.createHttpParameterValue(org.apache.cxf.jaxrs.model.Parameter,java.lang.Class,java.lang.reflect.Type,java.lang.annotation.Annotation[],org.apache.cxf.message.Message,javax.ws.rs.core.MultivaluedMap,org.apache.cxf.jaxrs.model.OperationResourceInfo)"
        }
      ]
    },
    "logging": {
      "operations": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.logging.Log.trace:void(java.lang.Object)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.logging.Log.trace:void(java.lang.Object,java.lang.Throwable)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.logging.Log.debug:void(java.lang.Object)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.logging.Log.debug:void(java.lang.Object,java.lang.Throwable)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.logging.Log.info:void(java.lang.Object)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.logging.Log.info:void(java.lang.Object,java.lang.Throwable)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.logging.Log.warn:void(java.lang.Object)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.logging.Log.warn:void(java.lang.Object,java.lang.Throwable)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.logging.Log.error:void(java.lang.Object)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.logging.Log.error:void(java.lang.Object,java.lang.Throwable)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.logging.Log.fatal:void(java.lang.Object)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.logging.Log.fatal:void(java.lang.Object,java.lang.Throwable)"
        }
      ]
    },
    "security": {
      "sanitization": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.jackrabbit.util.Text.encodeIllegalXMLCharacters(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.catalina.util.URLEncoder.encode(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.escapeHtml(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.escapeJavaScript(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.escapeXml(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.escapeSQL(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.unescapeHtml(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.unescapeJavaScript(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.unescapeXml(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeCsv(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeHtml3(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeHtml4(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeJson(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeXml(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeXml10(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeXml11(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.escapeSql(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.unescapeCsv(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.unescapeHtml3(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.unescapeHtml4(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.unescapeJson(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.unescapeXml(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.taglibs.standard.tag.common.core.Util.escapeXml(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.taglibs.standard.util.EscapeXML.escape(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.escapeCsv(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.escapeCsv(java.io.Writer,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.unescapeCsv(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.unescapeCsv(java.io.Writer,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.escapeHtml(java.io.Writer,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.unescapeHtml(java.io.Writer,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.escapeJavaScript(java.io.Writer,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.unescapeJavaScript(java.io.Writer,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.escapeXml(java.io.Writer,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang.StringEscapeUtils.unescapeXml(java.io.Writer,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringUtils.strip:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringUtils.stripAll:java.lang.String[](java.lang.String[])"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringUtils.stripToNull:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringUtils.stripToEmpty:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringUtils.trim:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringUtils.trimToNull:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringUtils.trimToEmpty:java.lang.String(java.lang.String)"
        }
      ],
      "input_validation": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.validator.GenericValidator.isBlankOrNull:boolean(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.validator.GenericValidator.isEmail:boolean(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.validator.GenericValidator.isUrl:boolean(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.validator.GenericValidator.isInRange:boolean(int,int,int)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.validator.GenericValidator.matchRegexp:boolean(java.lang.String,java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.validator.routines.EmailValidator.isValid:boolean(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.validator.routines.UrlValidator.isValid:boolean(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.validator.routines.RegexValidator.isValid:boolean(java.lang.String)"
        }
      ],
      "output_encoding": [
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.text.StringEscapeUtils.escapeHtml4:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.text.StringEscapeUtils.escapeHtml3:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.text.StringEscapeUtils.escapeXml10:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.text.StringEscapeUtils.escapeXml11:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.text.StringEscapeUtils.escapeEcmaScript:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.text.StringEscapeUtils.escapeJson:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.text.StringEscapeUtils.escapeJava:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.text.StringEscapeUtils.escapeCsv:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeHtml4:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeHtml3:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeXml:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeXml10:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeXml11:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeEcmaScript:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeJson:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeJava:java.lang.String(java.lang.String)"
        },
        {
          "target": "joern",
          "search_type": "method_signature",
          "signature": "org.apache.commons.lang3.StringEscapeUtils.escapeCsv:java.lang.String(java.lang.String)"
        }
      ]
    }
  }
}
